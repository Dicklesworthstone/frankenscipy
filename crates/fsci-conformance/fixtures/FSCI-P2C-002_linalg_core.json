{
  "packet_id": "FSCI-P2C-002",
  "family": "linalg_core",
  "cases": [
    {
      "operation": "solve",
      "case_id": "solve_general_2x2",
      "mode": "Strict",
      "a": [
        [
          3.0,
          2.0
        ],
        [
          1.0,
          2.0
        ]
      ],
      "b": [
        5.0,
        5.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          0.0,
          2.5
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_diagonal_ill_conditioned_warning",
      "mode": "Strict",
      "a": [
        [
          1e-14,
          0.0
        ],
        [
          0.0,
          1.0
        ]
      ],
      "b": [
        1e-14,
        1.0
      ],
      "assume_a": "diagonal",
      "expected": {
        "kind": "vector",
        "values": [
          1.0,
          1.0
        ],
        "atol": 1e-12,
        "rtol": 1e-12,
        "expect_warning_ill_conditioned": true
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_shape_mismatch",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          0.0,
          1.0
        ]
      ],
      "b": [
        1.0
      ],
      "expected": {
        "kind": "error",
        "error": "incompatible shapes: a_shape=(2, 2), b_len=1"
      }
    },
    {
      "operation": "solve_triangular",
      "case_id": "solve_triangular_lower",
      "mode": "Strict",
      "a": [
        [
          2.0,
          0.0
        ],
        [
          3.0,
          4.0
        ]
      ],
      "b": [
        4.0,
        11.0
      ],
      "lower": true,
      "expected": {
        "kind": "vector",
        "values": [
          2.0,
          1.25
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve_triangular",
      "case_id": "solve_triangular_singular",
      "mode": "Strict",
      "a": [
        [
          0.0,
          0.0
        ],
        [
          3.0,
          4.0
        ]
      ],
      "b": [
        4.0,
        11.0
      ],
      "lower": true,
      "expected": {
        "kind": "error",
        "error": "singular matrix"
      }
    },
    {
      "operation": "solve_banded",
      "case_id": "solve_banded_tridiagonal_plus",
      "mode": "Strict",
      "l_and_u": [
        1,
        2
      ],
      "ab": [
        [
          0.0,
          0.0,
          -1.0,
          -1.0,
          -1.0
        ],
        [
          0.0,
          2.0,
          2.0,
          2.0,
          2.0
        ],
        [
          5.0,
          4.0,
          3.0,
          2.0,
          1.0
        ],
        [
          1.0,
          1.0,
          1.0,
          1.0,
          0.0
        ]
      ],
      "b": [
        0.0,
        1.0,
        2.0,
        2.0,
        3.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          -2.37288136,
          3.93220339,
          -4.0,
          4.3559322,
          -1.3559322
        ],
        "atol": 1e-08,
        "rtol": 1e-08
      }
    },
    {
      "operation": "solve_banded",
      "case_id": "solve_banded_invalid_band_shape",
      "mode": "Strict",
      "l_and_u": [
        1,
        2
      ],
      "ab": [
        [
          0.0,
          0.0,
          -1.0,
          -1.0,
          -1.0
        ],
        [
          0.0,
          2.0,
          2.0,
          2.0,
          2.0
        ],
        [
          5.0,
          4.0,
          3.0,
          2.0,
          1.0
        ]
      ],
      "b": [
        0.0,
        1.0,
        2.0,
        2.0,
        3.0
      ],
      "expected": {
        "kind": "error",
        "error": "invalid values for the number of lower and upper diagonals: expected 4 rows in ab, got 3"
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_2x2",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0
        ],
        [
          3.0,
          4.0
        ]
      ],
      "expected": {
        "kind": "matrix",
        "values": [
          [
            -2.0,
            1.0
          ],
          [
            1.5,
            -0.5
          ]
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_singular",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0
        ],
        [
          2.0,
          4.0
        ]
      ],
      "expected": {
        "kind": "error",
        "error": "singular matrix"
      }
    },
    {
      "operation": "det",
      "case_id": "det_3x3",
      "mode": "Strict",
      "a": [
        [
          0.0,
          2.0,
          3.0
        ],
        [
          4.0,
          5.0,
          6.0
        ],
        [
          7.0,
          8.0,
          9.0
        ]
      ],
      "expected": {
        "kind": "scalar",
        "value": 3.0,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "det",
      "case_id": "det_non_square",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0,
          3.0
        ],
        [
          4.0,
          5.0,
          6.0
        ]
      ],
      "expected": {
        "kind": "error",
        "error": "expected square matrix"
      }
    },
    {
      "operation": "lstsq",
      "case_id": "lstsq_overdetermined",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          1.0,
          1.0
        ],
        [
          1.0,
          2.0
        ],
        [
          1.0,
          3.0
        ]
      ],
      "b": [
        1.0,
        2.0,
        2.0,
        4.0
      ],
      "expected": {
        "kind": "lstsq",
        "x": [
          0.9,
          0.9
        ],
        "residuals": [
          0.7
        ],
        "rank": 2,
        "singular_values": [
          4.10003044816824,
          1.090756766696107
        ],
        "atol": 1e-09,
        "rtol": 1e-09
      }
    },
    {
      "operation": "lstsq",
      "case_id": "lstsq_shape_mismatch",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          1.0,
          1.0
        ],
        [
          1.0,
          2.0
        ],
        [
          1.0,
          3.0
        ]
      ],
      "b": [
        1.0,
        2.0,
        2.0
      ],
      "expected": {
        "kind": "error",
        "error": "incompatible shapes: a_shape=(4, 2), b_len=3"
      }
    },
    {
      "operation": "pinv",
      "case_id": "pinv_rectangular",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          0.0,
          1.0
        ],
        [
          0.0,
          0.0
        ]
      ],
      "expected": {
        "kind": "pinv",
        "values": [
          [
            1.0,
            0.0,
            0.0
          ],
          [
            0.0,
            1.0,
            0.0
          ]
        ],
        "rank": 2,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "pinv",
      "case_id": "pinv_invalid_thresholds",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          0.0,
          1.0
        ]
      ],
      "atol": -1.0,
      "expected": {
        "kind": "error",
        "error": "atol and rtol values must be positive."
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_3x3_general",
      "mode": "Strict",
      "a": [
        [
          2.0,
          1.0,
          1.0
        ],
        [
          4.0,
          3.0,
          3.0
        ],
        [
          8.0,
          7.0,
          9.0
        ]
      ],
      "b": [
        1.0,
        1.0,
        1.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          1.0,
          -1.0,
          0.0
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_identity_3x3",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0,
          0.0
        ],
        [
          0.0,
          1.0,
          0.0
        ],
        [
          0.0,
          0.0,
          1.0
        ]
      ],
      "b": [
        1.0,
        2.0,
        3.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          1.0,
          2.0,
          3.0
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_symmetric_spd",
      "mode": "Strict",
      "a": [
        [
          4.0,
          2.0
        ],
        [
          2.0,
          3.0
        ]
      ],
      "b": [
        1.0,
        1.0
      ],
      "assume_a": "symmetric",
      "expected": {
        "kind": "vector",
        "values": [
          0.125,
          0.25
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_transposed",
      "mode": "Strict",
      "a": [
        [
          3.0,
          2.0
        ],
        [
          1.0,
          2.0
        ]
      ],
      "b": [
        5.0,
        5.0
      ],
      "transposed": true,
      "expected": {
        "kind": "vector",
        "values": [
          1.2500000000000002,
          1.2499999999999998
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_3x3",
      "mode": "Strict",
      "a": [
        [
          2.0,
          1.0,
          1.0
        ],
        [
          4.0,
          3.0,
          3.0
        ],
        [
          8.0,
          7.0,
          9.0
        ]
      ],
      "expected": {
        "kind": "matrix",
        "values": [
          [
            1.4999999999999993,
            -0.49999999999999933,
            -1.6653345369377348e-16
          ],
          [
            -2.999999999999999,
            2.4999999999999987,
            -0.49999999999999956
          ],
          [
            0.9999999999999996,
            -1.4999999999999993,
            0.4999999999999998
          ]
        ],
        "atol": 1e-10,
        "rtol": 1e-10
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_diagonal_3x3",
      "mode": "Strict",
      "a": [
        [
          5.0,
          0.0,
          0.0
        ],
        [
          0.0,
          2.0,
          0.0
        ],
        [
          0.0,
          0.0,
          8.0
        ]
      ],
      "expected": {
        "kind": "matrix",
        "values": [
          [
            0.2,
            0.0,
            0.0
          ],
          [
            0.0,
            0.5,
            0.0
          ],
          [
            0.0,
            0.0,
            0.125
          ]
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "det",
      "case_id": "det_2x2",
      "mode": "Strict",
      "a": [
        [
          4.0,
          6.0
        ],
        [
          3.0,
          8.0
        ]
      ],
      "expected": {
        "kind": "scalar",
        "value": 13.999999999999998,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "det",
      "case_id": "det_1x1",
      "mode": "Strict",
      "a": [
        [
          7.0
        ]
      ],
      "expected": {
        "kind": "scalar",
        "value": 7.0,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "det",
      "case_id": "det_identity_4x4",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0,
          0.0,
          0.0
        ],
        [
          0.0,
          1.0,
          0.0,
          0.0
        ],
        [
          0.0,
          0.0,
          1.0,
          0.0
        ],
        [
          0.0,
          0.0,
          0.0,
          1.0
        ]
      ],
      "expected": {
        "kind": "scalar",
        "value": 1.0,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "lstsq",
      "case_id": "lstsq_underdetermined",
      "mode": "Strict",
      "a": [
        [
          1.0,
          1.0
        ]
      ],
      "b": [
        2.0
      ],
      "expected": {
        "kind": "lstsq",
        "x": [
          0.9999999999999996,
          0.9999999999999999
        ],
        "residuals": [],
        "rank": 1,
        "singular_values": [
          1.4142135623730951
        ],
        "atol": 1e-09,
        "rtol": 1e-09
      }
    },
    {
      "operation": "pinv",
      "case_id": "pinv_square",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0
        ],
        [
          3.0,
          4.0
        ]
      ],
      "expected": {
        "kind": "pinv",
        "values": [
          [
            -2.0000000000000018,
            1.0000000000000007
          ],
          [
            1.5000000000000018,
            -0.5000000000000007
          ]
        ],
        "rank": 2,
        "atol": 1e-10,
        "rtol": 1e-10
      }
    },
    {
      "operation": "solve_triangular",
      "case_id": "solve_triangular_upper",
      "mode": "Strict",
      "a": [
        [
          3.0,
          1.0
        ],
        [
          0.0,
          2.0
        ]
      ],
      "b": [
        5.0,
        4.0
      ],
      "lower": false,
      "expected": {
        "kind": "vector",
        "values": [
          1.0,
          2.0
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve_triangular",
      "case_id": "solve_triangular_transpose",
      "mode": "Strict",
      "a": [
        [
          2.0,
          0.0
        ],
        [
          3.0,
          4.0
        ]
      ],
      "b": [
        4.0,
        11.0
      ],
      "lower": true,
      "trans": "transpose",
      "expected": {
        "kind": "vector",
        "values": [
          -2.125,
          2.75
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve_triangular",
      "case_id": "solve_triangular_unit_diag",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          3.0,
          1.0
        ]
      ],
      "b": [
        4.0,
        11.0
      ],
      "lower": true,
      "unit_diagonal": true,
      "expected": {
        "kind": "vector",
        "values": [
          4.0,
          -1.0
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_lower_triangular",
      "mode": "Strict",
      "a": [
        [
          2.0,
          0.0
        ],
        [
          3.0,
          4.0
        ]
      ],
      "assume_a": "lower_triangular",
      "expected": {
        "kind": "matrix",
        "values": [
          [
            0.5,
            0.0
          ],
          [
            -0.375,
            0.25
          ]
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_1x1",
      "mode": "Strict",
      "a": [
        [
          5.0
        ]
      ],
      "b": [
        10.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          2.0
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "det",
      "case_id": "det_4x4",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0,
          3.0,
          4.0
        ],
        [
          5.0,
          6.0,
          7.0,
          8.0
        ],
        [
          9.0,
          10.0,
          12.0,
          13.0
        ],
        [
          14.0,
          15.0,
          16.0,
          20.0
        ]
      ],
      "expected": {
        "kind": "scalar",
        "value": -11.999999999999979,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "lstsq",
      "case_id": "lstsq_exact_square",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          0.0,
          1.0
        ]
      ],
      "b": [
        3.0,
        4.0
      ],
      "expected": {
        "kind": "lstsq",
        "x": [
          3.0,
          4.0
        ],
        "residuals": [],
        "rank": 2,
        "singular_values": [
          1.0,
          1.0
        ],
        "atol": 1e-09,
        "rtol": 1e-09
      }
    },
    {
      "operation": "pinv",
      "case_id": "pinv_zero_matrix",
      "mode": "Strict",
      "a": [
        [
          0.0,
          0.0
        ],
        [
          0.0,
          0.0
        ]
      ],
      "expected": {
        "kind": "pinv",
        "values": [
          [
            0.0,
            0.0
          ],
          [
            0.0,
            0.0
          ]
        ],
        "rank": 0,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_nonsquare_error",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0,
          3.0
        ],
        [
          4.0,
          5.0,
          6.0
        ]
      ],
      "b": [
        1.0,
        2.0
      ],
      "expected": {
        "kind": "error",
        "error": "expected square matrix"
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_nonsquare_error",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0,
          3.0
        ],
        [
          4.0,
          5.0,
          6.0
        ]
      ],
      "expected": {
        "kind": "error",
        "error": "expected square matrix"
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_10x10_diag_dominant",
      "mode": "Strict",
      "a": [
        [
          7.63266915454487,
          -0.13826430117118466,
          0.6476885381006925,
          1.5230298564080254,
          -0.23415337472333597,
          -0.23413695694918055,
          1.5792128155073915,
          0.7674347291529088,
          -0.4694743859349521,
          0.5425600435859647
        ],
        [
          -0.46341769281246226,
          10.019001554146756,
          0.24196227156603412,
          -1.913280244657798,
          -1.7249178325130328,
          -0.5622875292409727,
          -1.0128311203344238,
          0.3142473325952739,
          -0.9080240755212109,
          -1.4123037013352915
        ],
        [
          1.465648768921554,
          -0.22577630048653566,
          7.258030810024575,
          -1.4247481862134568,
          -0.5443827245251827,
          0.11092258970986608,
          -1.1509935774223028,
          0.37569801834567196,
          -0.600638689918805,
          -0.2916937497932768
        ],
        [
          -0.6017066122293969,
          1.8522781845089378,
          -0.013497224737933921,
          10.262162516158465,
          0.822544912103189,
          -1.2208436499710222,
          0.2088635950047554,
          -1.9596701238797756,
          -1.3281860488984305,
          0.19686123586912352
        ],
        [
          0.7384665799954104,
          0.1713682811899705,
          -0.11564828238824053,
          -0.3011036955892888,
          8.149372480034945,
          -0.7198442083947086,
          -0.4606387709597875,
          1.0571222262189157,
          0.3436182895684614,
          -1.763040155362734
        ],
        [
          0.324083969394795,
          -0.38508228041631654,
          -0.6769220003059587,
          0.6116762888408679,
          1.030999522495951,
          7.415282638169864,
          -0.8392175232226385,
          -0.3092123758512146,
          0.33126343140356396,
          0.9755451271223592
        ],
        [
          -0.47917423784528995,
          -0.18565897666381712,
          -1.1063349740060282,
          -1.1962066240806708,
          0.812525822394198,
          1.356240028570823,
          8.218439462685943,
          1.0035328978920242,
          0.36163602504763415,
          -0.6451197546051243
        ],
        [
          0.36139560550841393,
          1.5380365664659692,
          -0.03582603910995154,
          1.5646436558140062,
          -2.6197451040897444,
          0.8219025043752238,
          0.08704706823817122,
          10.406933585203744,
          0.0917607765355023,
          -1.9875689146008928
        ],
        [
          -0.21967188783751193,
          0.3571125715117464,
          1.477894044741516,
          -0.5182702182736474,
          -0.8084936028931876,
          -0.5017570435845365,
          0.9154021177020741,
          0.32875110965968446,
          7.170380233084298,
          0.5132674331133561
        ],
        [
          0.09707754934804039,
          0.9686449905328892,
          -0.7020530938773524,
          -0.3276621465977682,
          -0.39210815313215763,
          -1.4635149481321186,
          0.29612027706457605,
          0.26105527217988933,
          0.00511345664246089,
          5.7479370208824
        ]
      ],
      "b": [
        1.0,
        2.0,
        3.0,
        4.0,
        5.0,
        6.0,
        7.0,
        8.0,
        9.0,
        10.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          -0.3358598047280307,
          0.8542959849070371,
          0.8905550883023652,
          0.4937939646315658,
          0.9783029049831918,
          0.6243676443274344,
          0.812794371228029,
          1.1222297437278994,
          0.9193579426110134,
          1.8704330562834395
        ],
        "atol": 1e-08,
        "rtol": 1e-08
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_10x10_diag_dominant",
      "mode": "Strict",
      "a": [
        [
          7.63266915454487,
          -0.13826430117118466,
          0.6476885381006925,
          1.5230298564080254,
          -0.23415337472333597,
          -0.23413695694918055,
          1.5792128155073915,
          0.7674347291529088,
          -0.4694743859349521,
          0.5425600435859647
        ],
        [
          -0.46341769281246226,
          10.019001554146756,
          0.24196227156603412,
          -1.913280244657798,
          -1.7249178325130328,
          -0.5622875292409727,
          -1.0128311203344238,
          0.3142473325952739,
          -0.9080240755212109,
          -1.4123037013352915
        ],
        [
          1.465648768921554,
          -0.22577630048653566,
          7.258030810024575,
          -1.4247481862134568,
          -0.5443827245251827,
          0.11092258970986608,
          -1.1509935774223028,
          0.37569801834567196,
          -0.600638689918805,
          -0.2916937497932768
        ],
        [
          -0.6017066122293969,
          1.8522781845089378,
          -0.013497224737933921,
          10.262162516158465,
          0.822544912103189,
          -1.2208436499710222,
          0.2088635950047554,
          -1.9596701238797756,
          -1.3281860488984305,
          0.19686123586912352
        ],
        [
          0.7384665799954104,
          0.1713682811899705,
          -0.11564828238824053,
          -0.3011036955892888,
          8.149372480034945,
          -0.7198442083947086,
          -0.4606387709597875,
          1.0571222262189157,
          0.3436182895684614,
          -1.763040155362734
        ],
        [
          0.324083969394795,
          -0.38508228041631654,
          -0.6769220003059587,
          0.6116762888408679,
          1.030999522495951,
          7.415282638169864,
          -0.8392175232226385,
          -0.3092123758512146,
          0.33126343140356396,
          0.9755451271223592
        ],
        [
          -0.47917423784528995,
          -0.18565897666381712,
          -1.1063349740060282,
          -1.1962066240806708,
          0.812525822394198,
          1.356240028570823,
          8.218439462685943,
          1.0035328978920242,
          0.36163602504763415,
          -0.6451197546051243
        ],
        [
          0.36139560550841393,
          1.5380365664659692,
          -0.03582603910995154,
          1.5646436558140062,
          -2.6197451040897444,
          0.8219025043752238,
          0.08704706823817122,
          10.406933585203744,
          0.0917607765355023,
          -1.9875689146008928
        ],
        [
          -0.21967188783751193,
          0.3571125715117464,
          1.477894044741516,
          -0.5182702182736474,
          -0.8084936028931876,
          -0.5017570435845365,
          0.9154021177020741,
          0.32875110965968446,
          7.170380233084298,
          0.5132674331133561
        ],
        [
          0.09707754934804039,
          0.9686449905328892,
          -0.7020530938773524,
          -0.3276621465977682,
          -0.39210815313215763,
          -1.4635149481321186,
          0.29612027706457605,
          0.26105527217988933,
          0.00511345664246089,
          5.7479370208824
        ]
      ],
      "expected": {
        "kind": "matrix",
        "values": [
          [
            0.1319080661286971,
            0.008334632510099419,
            -0.01818364696796743,
            -0.02224633392897163,
            0.004623965897265276,
            0.004700339237683996,
            -0.025390004175171697,
            -0.011123907537170526,
            0.005044442611792835,
            -0.01709014181521376
          ],
          [
            0.005999870015146751,
            0.094545278066391,
            -0.0009129729977179961,
            0.019193905114331528,
            0.016702738312644728,
            0.016144114687593407,
            0.010122204087327351,
            -0.0028626893508769784,
            0.013807743321988315,
            0.023256687390398136
          ],
          [
            -0.024060444177865042,
            -0.0029018725385905044,
            0.1417495170755133,
            0.026577704310844198,
            0.004541378243389007,
            0.0007288039878420335,
            0.021927208833654788,
            -0.0014786616986180636,
            0.013508816088789052,
            0.009853968089775662
          ],
          [
            0.005892688719105798,
            -0.018506818041890947,
            -0.0033844658295149824,
            0.08863364935031352,
            -0.006755408753271098,
            0.011361439535201625,
            -0.006834529934438911,
            0.018374521664455155,
            0.014090604152926864,
            -0.00798277825122321
          ],
          [
            -0.012829577144587342,
            -0.0038600727206707544,
            0.010484613237627408,
            0.00865425095613926,
            0.11566684127301352,
            0.016734767613532785,
            0.011042349700581551,
            -0.01060879631690664,
            -0.005607032449697147,
            0.031207618666387386
          ],
          [
            -0.005189210627343803,
            0.0077495907535498395,
            0.01338494799928025,
            -0.003225413711251668,
            -0.015197946844707554,
            0.1254560959557758,
            0.017060915284935134,
            0.0033192733935460865,
            -0.004791430130904463,
            -0.01928000801810471
          ],
          [
            0.007952665148681204,
            -0.000454512293227518,
            0.016368272941036946,
            0.01723292695366399,
            -0.012571280709251597,
            -0.01746273641618498,
            0.1191799831725431,
            -0.00888899478025012,
            0.0005322581343078622,
            0.008740877889683245
          ],
          [
            -0.010907543508351781,
            -0.01591072203100635,
            0.007413765190901655,
            -0.012061751196141748,
            0.028854987679857596,
            -0.00377190667242215,
            0.0010807117028280605,
            0.09091056802970644,
            -0.0067968713866779695,
            0.03956432584680246
          ],
          [
            0.007372190853509699,
            -0.003222917008039308,
            -0.03175430543138354,
            -0.0019546200161898353,
            0.010101127581749983,
            0.01078259776041091,
            -0.01911654102252267,
            -0.002418681152717097,
            0.13654011984469785,
            -0.01693840845616087
          ],
          [
            -0.007959063238674034,
            -0.01502425015017119,
            0.02055284599027519,
            0.004870810426016385,
            0.0006257187119330957,
            0.03208272456159417,
            -6.30936754027952e-05,
            -0.0020102421703716137,
            -0.0014015424700084067,
            0.16608113745392022
          ]
        ],
        "atol": 1e-06,
        "rtol": 1e-06
      }
    },
    {
      "operation": "solve_banded",
      "case_id": "solve_banded_tridiagonal",
      "mode": "Strict",
      "l_and_u": [
        1,
        1
      ],
      "ab": [
        [
          0.0,
          -1.0,
          -1.0
        ],
        [
          2.0,
          3.0,
          2.0
        ],
        [
          1.0,
          1.0,
          0.0
        ]
      ],
      "b": [
        1.0,
        2.0,
        3.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          0.875,
          0.75,
          1.1250000000000002
        ],
        "atol": 1e-10,
        "rtol": 1e-10
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_spd_3x3",
      "mode": "Strict",
      "a": [
        [
          10.0,
          1.0,
          2.0
        ],
        [
          1.0,
          8.0,
          1.0
        ],
        [
          2.0,
          1.0,
          6.0
        ]
      ],
      "b": [
        1.0,
        2.0,
        3.0
      ],
      "assume_a": "positive_definite",
      "expected": {
        "kind": "vector",
        "values": [
          -0.013761467889908268,
          0.19266055045871555,
          0.4724770642201836
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_hilbert_4x4",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.5,
          0.3333333333333333,
          0.25
        ],
        [
          0.5,
          0.3333333333333333,
          0.25,
          0.2
        ],
        [
          0.3333333333333333,
          0.25,
          0.2,
          0.16666666666666666
        ],
        [
          0.25,
          0.2,
          0.16666666666666666,
          0.14285714285714285
        ]
      ],
      "b": [
        1.0,
        1.0,
        1.0,
        1.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          -3.999999999999357,
          59.99999999999229,
          -179.99999999998084,
          139.9999999999873
        ],
        "atol": 0.0001,
        "rtol": 0.0001
      }
    },
    {
      "operation": "det",
      "case_id": "det_hilbert_4x4",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.5,
          0.3333333333333333,
          0.25
        ],
        [
          0.5,
          0.3333333333333333,
          0.25,
          0.2
        ],
        [
          0.3333333333333333,
          0.25,
          0.2,
          0.16666666666666666
        ],
        [
          0.25,
          0.2,
          0.16666666666666666,
          0.14285714285714285
        ]
      ],
      "expected": {
        "kind": "scalar",
        "value": 1.653439153439039e-07,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "lstsq",
      "case_id": "lstsq_3x2_overdetermined",
      "mode": "Strict",
      "a": [
        [
          1.0,
          1.0
        ],
        [
          1.0,
          2.0
        ],
        [
          1.0,
          3.0
        ]
      ],
      "b": [
        6.0,
        5.0,
        7.0
      ],
      "expected": {
        "kind": "lstsq",
        "x": [
          5.000000000000002,
          0.5000000000000001
        ],
        "residuals": [
          1.4999999999999998
        ],
        "rank": 2,
        "singular_values": [
          4.079143328941734,
          0.6004912172131635
        ],
        "atol": 1e-09,
        "rtol": 1e-09
      }
    },
    {
      "operation": "pinv",
      "case_id": "pinv_3x2_tall",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0
        ],
        [
          0.0,
          1.0
        ],
        [
          1.0,
          1.0
        ]
      ],
      "expected": {
        "kind": "pinv",
        "values": [
          [
            0.6666666666666663,
            -0.3333333333333332,
            0.3333333333333332
          ],
          [
            -0.33333333333333326,
            0.6666666666666665,
            0.3333333333333333
          ]
        ],
        "rank": 2,
        "atol": 1e-10,
        "rtol": 1e-10
      }
    },
    {
      "operation": "pinv",
      "case_id": "pinv_2x3_wide",
      "mode": "Strict",
      "a": [
        [
          1.0,
          0.0,
          1.0
        ],
        [
          0.0,
          1.0,
          1.0
        ]
      ],
      "expected": {
        "kind": "pinv",
        "values": [
          [
            0.6666666666666664,
            -0.3333333333333331
          ],
          [
            -0.33333333333333337,
            0.6666666666666666
          ],
          [
            0.3333333333333331,
            0.3333333333333334
          ]
        ],
        "rank": 2,
        "atol": 1e-10,
        "rtol": 1e-10
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_4x4_general",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0,
          0.0,
          1.0
        ],
        [
          3.0,
          1.0,
          2.0,
          0.0
        ],
        [
          0.0,
          1.0,
          3.0,
          2.0
        ],
        [
          2.0,
          0.0,
          1.0,
          4.0
        ]
      ],
      "b": [
        10.0,
        13.0,
        15.0,
        18.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          2.025316455696203,
          2.5189873417721516,
          2.20253164556962,
          2.936708860759494
        ],
        "atol": 1e-10,
        "rtol": 1e-10
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_4x4",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0,
          0.0,
          1.0
        ],
        [
          3.0,
          1.0,
          2.0,
          0.0
        ],
        [
          0.0,
          1.0,
          3.0,
          2.0
        ],
        [
          2.0,
          0.0,
          1.0,
          4.0
        ]
      ],
      "expected": {
        "kind": "matrix",
        "values": [
          [
            -0.025316455696202528,
            0.26582278481012656,
            -0.21518987341772153,
            0.11392405063291142
          ],
          [
            0.4810126582278481,
            -0.05063291139240504,
            0.08860759493670886,
            -0.16455696202531647
          ],
          [
            -0.20253164556962022,
            0.12658227848101264,
            0.27848101265822783,
            -0.08860759493670887
          ],
          [
            0.06329113924050633,
            -0.16455696202531647,
            0.03797468354430379,
            0.21518987341772156
          ]
        ],
        "atol": 1e-08,
        "rtol": 1e-08
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_vandermonde_4x4",
      "mode": "Strict",
      "a": [
        [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        [
          1.0,
          2.0,
          4.0,
          8.0
        ],
        [
          1.0,
          3.0,
          9.0,
          27.0
        ],
        [
          1.0,
          4.0,
          16.0,
          64.0
        ]
      ],
      "b": [
        10.0,
        26.0,
        58.0,
        112.0
      ],
      "expected": {
        "kind": "vector",
        "values": [
          4.0,
          3.0,
          2.0,
          1.0
        ],
        "atol": 1e-08,
        "rtol": 1e-08
      }
    },
    {
      "operation": "det",
      "case_id": "det_vandermonde_4x4",
      "mode": "Strict",
      "a": [
        [
          1.0,
          1.0,
          1.0,
          1.0
        ],
        [
          1.0,
          2.0,
          4.0,
          8.0
        ],
        [
          1.0,
          3.0,
          9.0,
          27.0
        ],
        [
          1.0,
          4.0,
          16.0,
          64.0
        ]
      ],
      "expected": {
        "kind": "scalar",
        "value": 11.999999999999948,
        "atol": 1e-12,
        "rtol": 1e-12
      }
    },
    {
      "operation": "solve",
      "case_id": "solve_singular_error",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0
        ],
        [
          2.0,
          4.0
        ]
      ],
      "b": [
        3.0,
        6.0
      ],
      "expected": {
        "kind": "error",
        "error": "singular matrix"
      }
    },
    {
      "operation": "inv",
      "case_id": "inv_singular_3x3_error",
      "mode": "Strict",
      "a": [
        [
          1.0,
          2.0,
          3.0
        ],
        [
          4.0,
          5.0,
          6.0
        ],
        [
          7.0,
          8.0,
          9.0
        ]
      ],
      "expected": {
        "kind": "error",
        "error": "singular matrix"
      }
    },
    {
      "operation": "lstsq",
      "case_id": "lstsq_rank_deficient",
      "mode": "Strict",
      "a": [
        [
          1.0,
          1.0
        ],
        [
          2.0,
          2.0
        ],
        [
          3.0,
          3.0
        ]
      ],
      "b": [
        2.0,
        4.0,
        6.0
      ],
      "expected": {
        "kind": "lstsq",
        "x": [
          1.0,
          1.0
        ],
        "residuals": [],
        "rank": 1,
        "singular_values": [
          5.2915026221291805,
          0.0
        ],
        "atol": 1e-06,
        "rtol": 1e-06
      }
    },
    {
      "operation": "solve_triangular",
      "case_id": "solve_triangular_upper_trans",
      "mode": "Strict",
      "a": [
        [
          3.0,
          1.0,
          0.0
        ],
        [
          0.0,
          2.0,
          1.0
        ],
        [
          0.0,
          0.0,
          4.0
        ]
      ],
      "b": [
        5.0,
        4.0,
        8.0
      ],
      "lower": false,
      "trans": "transpose",
      "expected": {
        "kind": "vector",
        "values": [
          1.6666666666666667,
          1.1666666666666665,
          1.7083333333333335
        ],
        "atol": 1e-12,
        "rtol": 1e-12
      }
    }
  ]
}
